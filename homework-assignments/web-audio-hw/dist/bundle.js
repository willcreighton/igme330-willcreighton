(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.r(t),e.d(t,{getLinearGradient:()=>b,getRandomColor:()=>p,goFullscreen:()=>g,makeColor:()=>m});var r,o,a,i,c,l,u,s,f,d,h,y,v,m=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(r,")")},p=function(){var e=function(){return 35,220,185*Math.random()+35};return"rgba(".concat(e(),",").concat(e(),",").concat(e(),",1)")},b=function(e,t,r,o,a,i){var c,l=e.createLinearGradient(t,r,o,a),u=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){l=!0,i=e},f:function(){try{c||null==r.return||r.return()}finally{if(l)throw i}}}}(i);try{for(u.s();!(c=u.n()).done;){var s=c.value;l.addColorStop(s.percent,s.color)}}catch(e){u.e(e)}finally{u.f()}return l},g=function(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullscreen?e.mozRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()},w=Object.freeze({gain:.5,numSamples:256}),S=function(e){o.src=e};function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,x(r.key),r)}}function x(e){var t=function(e,t){if("object"!=A(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=A(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==A(t)?t:t+""}var E,F,j,M=!0,k=function(){return e=function e(t,n,r,o,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ctx=t,this.x=n,this.y=r,this.size=o,this.color=a,this.rotation=i,this.velocityX=c,this.velocityY=l},(t=[{key:"update",value:function(){this.x+=this.velocityX,this.y+=this.velocityY,(this.x+this.size/2>f||this.x-this.size/2<0)&&(this.velocityX=-this.velocityX),(this.y+this.size/2>d||this.y-this.size/2<0)&&(this.velocityY=-this.velocityY),this.rotation+=.01;var e=1+v[0]/255;this.size=Math.max(10,Math.min(100,50*e))}},{key:"draw",value:function(){this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.rotate(this.rotation),this.ctx.fillStyle=this.color,this.ctx.fillRect(-this.size/2,-this.size/2,this.size,this.size),this.ctx.restore()}}])&&z(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();fetch("./data/av-data.json").then((function(e){return e.json()})).then((function(e){j=e})).catch((function(e){return console.error("Error loading data:",e)}));var C=Object.freeze({sound1:"media/New Adventure Theme.mp3"}),T={showGradient:!0,showBars:!0,showCircles:!0,showNoise:!1,showInvert:!1,showEmboss:!1},I=function(e){var t=document.querySelector("#fs-button"),n=document.querySelector("#play-button");t.onclick=function(){console.log("goFullscreen() called"),g(e)},n.onclick=function(){console.log("audioCtx.state before = ".concat(r.state)),"suspended"===r.state&&r.resume(),console.log("audioCtx.state after = ".concat(r.state)),"no"===n.dataset.playing?(o.play(),n.dataset.playing="yes"):(o.pause(),n.dataset.playing="no")};var a=document.querySelector("#volume-slider"),i=document.querySelector("#volume-label"),s=document.querySelector("#bass-slider"),f=document.querySelector("#bass-label"),d=document.querySelector("#treble-slider"),h=document.querySelector("#treble-label");a.oninput=function(e){var t;t=e.target.value,t=Number(t),c.gain.value=t,i.innerHTML=Math.round(e.target.value/2*100)},a.dispatchEvent(new Event("input")),s.oninput=function(e){var t;t=e.target.value,t=Number(t),l.gain.value=t,f.innerHTML=e.target.value},s.dispatchEvent(new Event("input")),d.oninput=function(e){var t;t=e.target.value,t=Number(t),u.gain.value=t,h.innerHTML=e.target.value},d.dispatchEvent(new Event("input")),document.querySelector("#track-select").onchange=function(e){S(e.target.value),"yes"===n.dataset.playing&&n.dispatchEvent(new MouseEvent("click"))}},O=performance.now(),R=function e(){var n=performance.now(),r=n-O;r>16.67?(O=n,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(M?y.getByteFrequencyData(v):y.getByteTimeDomainData(v),s.save(),s.fillStyle="black",s.globalAlpha=.1,s.fillRect(0,0,f,d),s.restore(),null==E&&(E=new k(s,f/2,d/2,j.spriteData.spriteSize,"rgba(255, 0, 0, 0.5)")),E.update(),E.draw(),null==F&&(F=new k(s,f/2,d/2,j.spriteData.spriteSize,"rgba(0, 0, 255, 0.5)",Math.PI/4,1,2)),F.update(),F.draw(),e.showGradient&&(s.save(),s.fillStyle=h,s.globalAlpha=.3,s.fillRect(0,0,f,d),s.restore()),e.showBars){var n=(f-4*v.length-10)/v.length;s.save(),s.fillStyle="rgba(0,0,255,0.50)",s.strokeStyle="rgba(0,0,255,0.75)";for(var r=0;r<v.length;r++)s.fillRect(5+r*(n+4),356-v[r],n,200),s.strokeRect(5+r*(n+4),356-v[r],n,200);s.restore()}if(e.showCircles){var o=d/4;s.save(),s.globalAlpha=.5;for(var a=function(){var e=v[i]/255,n=e*o,r=function(e,r){var o;s.beginPath(),s.fillStyle=m.apply(t,function(e){if(Array.isArray(e))return q(e)}(o=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?q(e,t):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s.arc(f/2,d/2,n*r,0,2*Math.PI,!1),s.fill(),s.closePath()};r([255,111,111,.34-e/3],1),r([0,0,255,.1-e/10],1.5),s.save(),r([200,200,0,.5-e/5],.5),s.restore()},i=0;i<v.length;i++)a();s.restore()}for(var c=s.getImageData(0,0,f,d),l=c.data,u=l.length,p=c.width,b=0;b<u;b+=4)if(e.showNoise&&Math.random()<.05&&(l[b]=l[b+1]=l[b+2]=0,l[b]=255),e.showInvert){var g=l[b],w=l[b+1],S=l[b+2];l[b]=255-g,l[b+1]=255-w,l[b+2]=255-S}if(e.showEmboss)for(var A=0;A<u;A++)A%4!=3&&(l[A]=127+2*l[A]-l[A+4]-l[A+4*p]);s.putImageData(c,0,0)}(T),setTimeout(e,1e3/60)):setTimeout(e,16.67-r)};window.onload=function(){console.log("window.onload called"),function(){var e,t;e=C.sound1,t=window.AudioContext||window.webkitAudioContext,r=new t,o=new Audio,S(e),a=r.createMediaElementSource(o),(i=r.createAnalyser()).fftSize=w.numSamples,(c=r.createGain()).gain.value=w.gain,(l=r.createBiquadFilter()).type="lowshelf",l.frequency.value=150,(u=r.createBiquadFilter()).type="highshelf",u.frequency.value=3e3,a.connect(i),i.connect(l),l.connect(u),u.connect(c),c.connect(r.destination),console.log("init called"),console.log("Testing utils.getRandomColor() import: ".concat(p()));var n=document.querySelector("canvas");I(n),function(e,t){s=e.getContext("2d"),f=e.width,d=e.height,h=b(s,0,0,0,d,[{percent:0,color:"#8B00FF"},{percent:.25,color:"#FF1493"},{percent:.5,color:"#FF69B4"},{percent:.75,color:"#4B0082"},{percent:1,color:"#000080"}]),y=t,v=new Uint8Array(y.fftSize/2),document.querySelector("#data-select").addEventListener("change",(function(e){var t=e.target.value;M="frequency"===t}))}(n,i),R();var m=function(e,t){e.addEventListener("change",(function(){T[t]=e.checked}))};m(document.querySelector("#gradient-cb"),"showGradient"),m(document.querySelector("#bars-cb"),"showBars"),m(document.querySelector("#circles-cb"),"showCircles"),m(document.querySelector("#noise-cb"),"showNoise"),m(document.querySelector("#invert-cb"),"showInvert"),m(document.querySelector("#emboss-cb"),"showEmboss")}()}})();